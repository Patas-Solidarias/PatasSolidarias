<div class="flex justify-end mb-4">
  <p-button label="Novo Usuário" icon="pi pi-plus" (click)="openNew()" styleClass="p-button-success"></p-button>
</div>

<p-table [value]="usuarios" dataKey="id" class="mt-3 shadow-lg rounded-lg">
  <ng-template pTemplate="header">
    <tr class="bg-gray-100">
      <th *ngFor="let col of columns" class="text-left p-3 font-semibold text-gray-700 uppercase text-sm">
        {{ col.header }}
      </th>
      <th class="text-left p-3 font-semibold text-gray-700 uppercase text-sm">Ações</th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-usuario>
    <tr class="hover:bg-gray-50">
      <td *ngFor="let item of columns" class="p-3 text-gray-800">
        <ng-container [ngSwitch]="item.field">
          <span *ngSwitchCase="'criadoDataHora'">{{ usuario[item.field] | date:'short' }}</span>
          <span *ngSwitchDefault>{{ usuario[item.field] }}</span>
        </ng-container>
      </td>
      <td class="p-3 flex gap-2">
        <p-button icon="pi pi-pencil" (click)="editUsuario(usuario)" styleClass="p-button-rounded p-button-info p-button-sm"></p-button>
        <p-button icon="pi pi-trash" (click)="deleteUsuario(usuario)" styleClass="p-button-rounded p-button-danger p-button-sm"></p-button>
      </td>
    </tr>
  </ng-template>
</p-table>

<p-dialog
  [(visible)]="usuarioDialog"
  [modal]="true"
  [header]="usuarioDialogTitle"
  [style]="{ width: '50vw' }"
  [baseZIndex]="10000"
  class="rounded-lg shadow-lg"
>
  <form [formGroup]="usuarioForm" (ngSubmit)="onSubmit()" class="space-y-6">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div class="flex flex-col">
        <label for="nome" class="mb-1 font-medium text-gray-700">Nome</label>
        <input
          id="nome"
          type="text"
          formControlName="nome"
          pInputText
          class="p-inputtext p-component rounded-md border-gray-300 focus:ring-2 focus:ring-blue-500"
        />
      </div>
      <div class="flex flex-col">
        <label for="email" class="mb-1 font-medium text-gray-700">Email</label>
        <input
          id="email"
          type="text"
          formControlName="email"
          pInputText
          class="p-inputtext p-component rounded-md border-gray-300 focus:ring-2 focus:ring-blue-500"
        />
      </div>
      <div class="flex flex-col md:col-span-2">
        <label for="senha" class="mb-1 font-medium text-gray-700">Senha</label>
        <input
          id="senha"
          type="password"
          formControlName="senha"
          pInputText
          class="p-inputtext p-component rounded-md border-gray-300 focus:ring-2 focus:ring-blue-500"
        />
      </div>
      <div class="flex flex-col md:col-span-2">
        <label for="descricao" class="mb-1 font-medium text-gray-700">Descricao</label>
        <input
          id="descricao"
          type="text"
          formControlName="descricao"
          pInputText
          class="p-inputtext p-component rounded-md border-gray-300 focus:ring-2 focus:ring-blue-500"
        />
      </div>
      <div class="flex flex-col md:col-span-2">
        <label for="usuarioTipoId" class="mb-1 font-medium text-gray-700">Tipo de usuário</label>
        <p-dropdown
          id="usuarioTipoId"
          formControlName="usuarioTipoId"
          [options]="usuarioTipos"
          optionLabel="label"
          optionValue="value"
          placeholder="Selecione o tipo"
          class="p-component rounded-md border-gray-300 focus:ring-2 focus:ring-blue-500"
        ></p-dropdown>
      </div>
    </div>
    <p-footer class="flex justify-end gap-2 mt-4">
      <button
        type="submit"
        pButton
        label="{{ usuarioDialogTitle }}"
        icon="pi pi-check"
        class="p-button-success hover:scale-105 transition-transform"
      ></button>
      <button
        type="button"
        pButton
        label="Cancelar"
        icon="pi pi-times"
        (click)="closeDialog()"
        class="p-button-secondary hover:scale-105 transition-transform"
      ></button>
    </p-footer>
  </form>
</p-dialog>
